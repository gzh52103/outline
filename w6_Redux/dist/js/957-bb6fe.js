(self.webpackChunkw5_reactrouter=self.webpackChunkw5_reactrouter||[]).push([[957],{8217:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>I});var a,n=s(7294),l=s(5977),i=s(4157),r=s(4210),o=s(2482),c=s(5779),m=s(5669),h=s(1577),j=s(1624);const u=(0,i.rN)("userInfo")(a=class extends n.Component{constructor(...e){super(...e),this.state={name:"",cities:[],categories:[]},this.onFinish=async e=>{const{userInfo:t}=this.props;console.log("onFinish=",e);const s=await j.ZP.post("/class",e,{headers:{Authorization:t.authrization}});console.log("data",s),201===s.code&&(r.ZP.success("添加成功"),this.props.history.push("/class/list"))},this.changeCategory=()=>{},this.changeCity=()=>{}}componentDidMount(){j.ZP.get("/category",{total:!1,size:100}).then((e=>{this.setState({categories:e.data})})),j.ZP.get("/city",{total:!1,size:100}).then((e=>{this.setState({cities:e.data})}))}render(){const{cities:e,categories:t}=this.state,s={name:[{required:!0,message:"请输入用户名"}]};return n.createElement("div",{className:"add-page"},n.createElement(o.Z,{name:"basic",labelCol:{span:8},wrapperCol:{span:12},initialValues:{category:"HTML5",city:"广州"},onFinish:this.onFinish},n.createElement(o.Z.Item,{label:"班级名称",name:"name",rules:s.name},n.createElement(c.Z,null)),n.createElement(o.Z.Item,{label:"学科",name:"category",rules:s.category},n.createElement(m.Z,{style:{width:120},onChange:this.changeCategory},t.map((e=>n.createElement(m.Z.Option,{key:e._id,value:e.name},e.name))))),n.createElement(o.Z.Item,{label:"分校",name:"city",rules:s.city},n.createElement(m.Z,{style:{width:120},onChange:this.changeCity},e.map((e=>n.createElement(m.Z.Option,{key:e._id,value:e.name},e.name))))),n.createElement(o.Z.Item,{wrapperCol:{offset:8,span:12}},n.createElement(h.Z,{type:"primary",htmlType:"submit"},"确认"))))}})||a;var d,p=s(5443),g=s(1230),y=s(5746),f=s(2284),E=s(8212),Z=s(3171),b=s(9101),z=s(381),k=s.n(z),v=s(7673);const w=(0,i.rN)("userInfo")(d=class extends n.Component{constructor(e){super(e),this.getData=async()=>{const{page:e,pageSize:t}=this.state,{data:s}=await j.ZP.get("/user",{page:e,size:t});console.log("data",s),this.setState({datalist:s})},this.getClass=async()=>{const{page:e,pageSize:t}=this.state,{data:s}=await j.ZP.get("/class",{page:e,size:t,size:100,total:!1});console.log("data",s),this.setState({classlist:s})},this.editItem=e=>{console.log("edit",e),this.props.history.push({pathname:"/student/"+e,search:v.stringify({username:"laoxie",password:123})})},this.removeItem=e=>{console.log("remove",e);const{userInfo:t}=this.props,{datalist:s}=this.state;j.ZP.delete("/user/"+e,{},{headers:{Authorization:t.authrization}}).then((t=>{204===t.code&&(r.ZP.success("删除成功"),this.setState({datalist:{total:s.total-1,result:s.result.filter((t=>t._id!==e))}}))}))},this.removeMany=async()=>{const{selectedRowKeys:e}=this.state;0!==e.length?204===(await j.ZP.delete("/user",{ids:e})).code&&(r.ZP.success("批量删除成功"),this.setState({datalist:{total:datalist.total-e.length,result:datalist.result.filter((t=>!e.find(t._id)))}})):r.ZP.warn("请选择删除的数据")},this.onSelect=(e,t)=>{console.log("select",e,t),this.setState({selectedRowKeys:e})},this.state={classlist:[],datalist:[],page:1,pageSize:10,selectedRowKeys:[]}}componentDidMount(){this.getData()}filterClass(e){const{classlist:t}=this.state;return t.find((t=>t._id===e))}render(){const{datalist:e}=this.state,t={total:e.total,showTotal:e=>`共${e}条数据`,size:"small",onChange:(e,t)=>{this.setState({page:e,pageSize:t},(()=>{this.getData()}))}},s=[{title:"学生姓名",dataIndex:"username",render:(e,t,s)=>{const a=this.filterClass(t.class_id);return n.createElement(n.Fragment,null,n.createElement("h4",null,e),n.createElement("p",null,a?"@"+a:""),n.createElement("p",null,"注册时间: ",k()(t.regtime).format("YYYY/MM/DD hh:mm:ss")))}},{title:"操作",key:"action",width:180,render:e=>n.createElement(n.Fragment,null,n.createElement(h.Z,{type:"primary",size:"small",ghost:!0,onClick:this.editItem.bind(this,e._id),icon:n.createElement(E.Z,null),style:{marginRight:5}},"编辑"),n.createElement(p.Z,{title:"确认删除",onConfirm:this.removeItem.bind(this,e._id)},n.createElement(h.Z,{icon:n.createElement(Z.Z,null),size:"small",danger:!0},"删除")))}];return n.createElement("div",null,n.createElement(g.Z,{gutter:10},n.createElement(y.Z,{span:12},n.createElement(h.Z,{type:"primary",icon:n.createElement(b.Z,null),onClick:()=>{this.props.history.push("/student/add")}},"添加")),n.createElement(y.Z,{span:12,style:{textAlign:"right"}},n.createElement(h.Z,{type:"primary",danger:!0,icon:n.createElement(Z.Z,null),onClick:this.removeMany},"批量删除"))),n.createElement(f.Z,{rowKey:"_id",rowSelection:{columnTitle:"#",columnWidth:20,fixed:!0,onChange:this.onSelect},columns:s,dataSource:e.result,pagination:t}))}})||d;var C;console.log("qs",v);const S=(0,i.rN)("userInfo")(C=class extends n.Component{constructor(...e){super(...e),this.state={userData:{},classData:{},name:"",cities:[],classlist:[]},this.onFinish=async e=>{const{userData:t}=this.state,{userInfo:s}=this.props;console.log("onFinish=",e),201===(await j.ZP.put("/user/"+t._id,e,{headers:{Authorization:s.authrization}})).code&&(r.ZP.success("修改成功"),this.props.history.push("/student/list"))}}componentDidMount(){const{params:e}=this.props.match;j.ZP.get("/class",{total:!1,size:100}).then((e=>{this.setState({classlist:e.data})})),j.ZP.get("/city",{total:!1,size:100}).then((e=>{this.setState({cities:e.data})})),j.ZP.get("/user/"+e.id).then((e=>{this.setState({userData:e.data}),j.ZP.get("/class/"+e.data.class_id).then((e=>{this.setState({classData:e.data||{}})}))}))}render(){console.log("Eidt.props",this.props),console.log("format=",v.parse(this.props.location.search.slice(1)));const{cities:e,classlist:t,userData:s,classData:a}=this.state;return n.createElement("div",{className:"add-page"},n.createElement(o.Z,{name:"basic",labelCol:{span:8},wrapperCol:{span:12},onFinish:this.onFinish,fields:[{name:"username",value:s.username},{name:"class_id",value:a.name}]},n.createElement(o.Z.Item,{label:"学生姓名",name:"username",rules:[{required:!0,message:"请输入用户名"}]},n.createElement(c.Z,null)),n.createElement(o.Z.Item,{label:"所在班级",name:"class_id"},n.createElement(m.Z,{style:{width:120}},t.map((e=>n.createElement(m.Z.Option,{key:e._id,value:e._id},e.name))))),n.createElement(o.Z.Item,{wrapperCol:{offset:8,span:12}},n.createElement(h.Z,{type:"primary",htmlType:"submit"},"确认"))))}})||C;function _(e){console.log("Student.props",e),(0,l.k6)(),(0,l.TH)(),(0,l.UO)(),(0,l.$B)("/home");const{match:t}=e;return n.createElement("div",null,n.createElement(l.rs,null,n.createElement(l.AW,{path:t.path+"/add",component:u}),n.createElement(l.AW,{path:t.path+"/list",component:w}),n.createElement(l.AW,{path:t.path+"/:id",component:S}),n.createElement(l.l_,{from:t.path,to:t.path+"/list",exact:!0})))}_=(0,l.EN)(_);const I=_=(0,i.ns)(_)},6700:(e,t,s)=>{var a={"./af":2786,"./af.js":2786,"./ar":867,"./ar-dz":4130,"./ar-dz.js":4130,"./ar-kw":6135,"./ar-kw.js":6135,"./ar-ly":6440,"./ar-ly.js":6440,"./ar-ma":7702,"./ar-ma.js":7702,"./ar-sa":6040,"./ar-sa.js":6040,"./ar-tn":7100,"./ar-tn.js":7100,"./ar.js":867,"./az":1083,"./az.js":1083,"./be":9808,"./be.js":9808,"./bg":8338,"./bg.js":8338,"./bm":7438,"./bm.js":7438,"./bn":8905,"./bn-bd":6225,"./bn-bd.js":6225,"./bn.js":8905,"./bo":1560,"./bo.js":1560,"./br":1278,"./br.js":1278,"./bs":622,"./bs.js":622,"./ca":2468,"./ca.js":2468,"./cs":5822,"./cs.js":5822,"./cv":877,"./cv.js":877,"./cy":7373,"./cy.js":7373,"./da":4780,"./da.js":4780,"./de":9740,"./de-at":217,"./de-at.js":217,"./de-ch":894,"./de-ch.js":894,"./de.js":9740,"./dv":5300,"./dv.js":5300,"./el":837,"./el.js":837,"./en-au":8348,"./en-au.js":8348,"./en-ca":7925,"./en-ca.js":7925,"./en-gb":2243,"./en-gb.js":2243,"./en-ie":6436,"./en-ie.js":6436,"./en-il":7207,"./en-il.js":7207,"./en-in":4175,"./en-in.js":4175,"./en-nz":6319,"./en-nz.js":6319,"./en-sg":1662,"./en-sg.js":1662,"./eo":2915,"./eo.js":2915,"./es":5655,"./es-do":5251,"./es-do.js":5251,"./es-mx":6112,"./es-mx.js":6112,"./es-us":1146,"./es-us.js":1146,"./es.js":5655,"./et":5603,"./et.js":5603,"./eu":7763,"./eu.js":7763,"./fa":6959,"./fa.js":6959,"./fi":1897,"./fi.js":1897,"./fil":2549,"./fil.js":2549,"./fo":4694,"./fo.js":4694,"./fr":4470,"./fr-ca":3049,"./fr-ca.js":3049,"./fr-ch":2330,"./fr-ch.js":2330,"./fr.js":4470,"./fy":5044,"./fy.js":5044,"./ga":9295,"./ga.js":9295,"./gd":2101,"./gd.js":2101,"./gl":8794,"./gl.js":8794,"./gom-deva":7884,"./gom-deva.js":7884,"./gom-latn":3168,"./gom-latn.js":3168,"./gu":5349,"./gu.js":5349,"./he":4206,"./he.js":4206,"./hi":94,"./hi.js":94,"./hr":316,"./hr.js":316,"./hu":2138,"./hu.js":2138,"./hy-am":1423,"./hy-am.js":1423,"./id":9218,"./id.js":9218,"./is":135,"./is.js":135,"./it":626,"./it-ch":150,"./it-ch.js":150,"./it.js":626,"./ja":9183,"./ja.js":9183,"./jv":4286,"./jv.js":4286,"./ka":2105,"./ka.js":2105,"./kk":7772,"./kk.js":7772,"./km":8758,"./km.js":8758,"./kn":9282,"./kn.js":9282,"./ko":3730,"./ko.js":3730,"./ku":1408,"./ku.js":1408,"./ky":3291,"./ky.js":3291,"./lb":6841,"./lb.js":6841,"./lo":5466,"./lo.js":5466,"./lt":7010,"./lt.js":7010,"./lv":7595,"./lv.js":7595,"./me":9861,"./me.js":9861,"./mi":5493,"./mi.js":5493,"./mk":5966,"./mk.js":5966,"./ml":7341,"./ml.js":7341,"./mn":5115,"./mn.js":5115,"./mr":370,"./mr.js":370,"./ms":9847,"./ms-my":1237,"./ms-my.js":1237,"./ms.js":9847,"./mt":2126,"./mt.js":2126,"./my":6165,"./my.js":6165,"./nb":4924,"./nb.js":4924,"./ne":6744,"./ne.js":6744,"./nl":3901,"./nl-be":9814,"./nl-be.js":9814,"./nl.js":3901,"./nn":3877,"./nn.js":3877,"./oc-lnc":2135,"./oc-lnc.js":2135,"./pa-in":5858,"./pa-in.js":5858,"./pl":4495,"./pl.js":4495,"./pt":9520,"./pt-br":7971,"./pt-br.js":7971,"./pt.js":9520,"./ro":6459,"./ro.js":6459,"./ru":1793,"./ru.js":1793,"./sd":950,"./sd.js":950,"./se":490,"./se.js":490,"./si":124,"./si.js":124,"./sk":4249,"./sk.js":4249,"./sl":4985,"./sl.js":4985,"./sq":1104,"./sq.js":1104,"./sr":9131,"./sr-cyrl":9915,"./sr-cyrl.js":9915,"./sr.js":9131,"./ss":5893,"./ss.js":5893,"./sv":8760,"./sv.js":8760,"./sw":1172,"./sw.js":1172,"./ta":7333,"./ta.js":7333,"./te":3110,"./te.js":3110,"./tet":2095,"./tet.js":2095,"./tg":7321,"./tg.js":7321,"./th":9041,"./th.js":9041,"./tk":9005,"./tk.js":9005,"./tl-ph":5768,"./tl-ph.js":5768,"./tlh":9444,"./tlh.js":9444,"./tr":2397,"./tr.js":2397,"./tzl":8254,"./tzl.js":8254,"./tzm":1106,"./tzm-latn":699,"./tzm-latn.js":699,"./tzm.js":1106,"./ug-cn":9288,"./ug-cn.js":9288,"./uk":7691,"./uk.js":7691,"./ur":3795,"./ur.js":3795,"./uz":6791,"./uz-latn":588,"./uz-latn.js":588,"./uz.js":6791,"./vi":9822,"./vi.js":9822,"./x-pseudo":4378,"./x-pseudo.js":4378,"./yo":5805,"./yo.js":5805,"./zh-cn":3839,"./zh-cn.js":3839,"./zh-hk":1500,"./zh-hk.js":1500,"./zh-mo":9807,"./zh-mo.js":9807,"./zh-tw":4152,"./zh-tw.js":4152};function n(e){var t=l(e);return s(t)}function l(e){if(!s.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=l,e.exports=n,n.id=6700}}]);