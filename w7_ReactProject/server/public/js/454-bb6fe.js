(self.webpackChunkw5_reactrouter=self.webpackChunkw5_reactrouter||[]).push([[454],{5454:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>v});var s,n=a(7294),i=a(5977),l=a(4210),o=a(2482),c=a(5779),r=a(5669),m=a(1577),h=a(1624),p=a(4494),d=a(4157);const u=(0,p.$j)((e=>({userInfo:e.userInfo})))(s=class extends n.Component{constructor(...e){super(...e),this.state={name:"",cities:[],categories:[]},this.onFinish=async e=>{const{userInfo:t}=this.props;console.log("onFinish=",e);const a=await h.ZP.post("/class",e,{});console.log("data",a),201===a.code&&(l.ZP.success("添加成功"),this.props.history.push("/class/list"))},this.changeCategory=()=>{},this.changeCity=()=>{}}componentDidMount(){h.ZP.get("/category",{total:!1,size:100}).then((e=>{this.setState({categories:e.data})})),h.ZP.get("/city",{total:!1,size:100}).then((e=>{this.setState({cities:e.data})}))}render(){const{cities:e,categories:t}=this.state,a={name:[{required:!0,message:"请输入用户名"}]};return n.createElement("div",{className:"add-page"},n.createElement(o.Z,{name:"basic",labelCol:{span:8},wrapperCol:{span:12},initialValues:{category:"HTML5",city:"广州"},onFinish:this.onFinish},n.createElement(o.Z.Item,{label:"班级名称",name:"name",rules:a.name},n.createElement(c.Z,null)),n.createElement(o.Z.Item,{label:"学科",name:"category",rules:a.category},n.createElement(r.Z,{style:{width:120},onChange:this.changeCategory},t.map((e=>n.createElement(r.Z.Option,{key:e._id,value:e.name},e.name))))),n.createElement(o.Z.Item,{label:"分校",name:"city",rules:a.city},n.createElement(r.Z,{style:{width:120},onChange:this.changeCity},e.map((e=>n.createElement(r.Z.Option,{key:e._id,value:e.name},e.name))))),n.createElement(o.Z.Item,{wrapperCol:{offset:8,span:12}},n.createElement(m.Z,{type:"primary",htmlType:"submit"},"确认"))))}})||s;var g,y=a(2284),Z=a(8212),E=a(3171);const C=(0,d.rN)("userInfo")(g=class extends n.Component{constructor(e){super(e),this.getData=async()=>{const{page:e,pageSize:t}=this.state,{data:a}=await h.ZP.get("/class",{page:e,size:t});console.log("data",a),this.setState({classList:a})},this.editItem=e=>{console.log("edit",e),this.props.history.push("/class/"+e)},this.removeItem=e=>{console.log("remove",e);const{userInfo:t}=this.props,{classList:a}=this.state;h.ZP.delete("/class/"+e,{},{headers:{Authorization:t.authrization}}).then((t=>{204===t.code&&(l.ZP.success("删除成功"),this.setState({classList:{total:a.total-1,result:a.result.filter((t=>t._id!==e))}}))}))},this.onSelect=(e,t)=>{console.log("select",e,t)},this.state={classList:[],page:1,pageSize:10}}componentDidMount(){this.getData()}render(){const{classList:e}=this.state,t={total:e.total,showTotal:e=>`共${e}条数据`,size:"small",onChange:(e,t)=>{this.setState({page:e,pageSize:t},(()=>{this.getData()}))}},a=[{title:"班级名称",dataIndex:"name"},{title:"学科",dataIndex:"category"},{title:"分校",dataIndex:"city"},{title:"操作",key:"action",width:180,render:e=>n.createElement(n.Fragment,null,n.createElement(m.Z,{type:"primary",size:"small",ghost:!0,onClick:this.editItem.bind(this,e._id),icon:n.createElement(Z.Z,null),style:{marginRight:5}},"编辑"),n.createElement(m.Z,{icon:n.createElement(E.Z,null),size:"small",danger:!0,onClick:this.removeItem.bind(this,e._id)},"删除"))}];return n.createElement("div",null,"班级列表",n.createElement(y.Z,{rowKey:"_id",rowSelection:{columnTitle:"#",columnWidth:20,fixed:!0,onChange:this.onSelect},columns:a,dataSource:e.result,pagination:t}))}})||g;var I;const w=(0,d.rN)("userInfo")(I=class extends n.Component{constructor(...e){super(...e),this.state={classData:{},name:"",cities:[],categories:[]},this.onFinish=async e=>{const{classData:t}=this.state,{userInfo:a}=this.props;console.log("onFinish=",e);const s=await h.ZP.put("/class/"+t._id,e,{headers:{Authorization:a.authrization}});console.log("data",s),201===s.code&&(l.ZP.success("添加成功"),this.props.history.push("/class/list"))},this.changeCategory=()=>{},this.changeCity=()=>{}}componentDidMount(){const{params:e}=this.props.match;h.ZP.get("/category",{total:!1,size:100}).then((e=>{this.setState({categories:e.data})})),h.ZP.get("/city",{total:!1,size:100}).then((e=>{this.setState({cities:e.data})})),h.ZP.get("/class/"+e.id).then((e=>{this.setState({classData:e.data})}))}render(){console.log("Eidt.props",this.props);const{cities:e,categories:t,classData:a}=this.state;return console.log("classData",a),n.createElement("div",{className:"add-page"},n.createElement(o.Z,{name:"basic",labelCol:{span:8},wrapperCol:{span:12},onFinish:this.onFinish,fields:[{name:"name",value:a.name},{name:"category",value:a.category},{name:"city",value:a.city}]},n.createElement(o.Z.Item,{label:"班级名称",name:"name",rules:[{required:!0,message:"请输入用户名"}],initialValue:a.name},n.createElement(c.Z,null)),n.createElement(o.Z.Item,{label:"学科",name:"category",initialValue:a.category},n.createElement(r.Z,{style:{width:120},onChange:this.changeCategory},t.map((e=>n.createElement(r.Z.Option,{key:e._id,value:e.name},e.name))))),n.createElement(o.Z.Item,{label:"分校",name:"city",initialValue:a.city},n.createElement(r.Z,{style:{width:120},onChange:this.changeCity},e.map((e=>n.createElement(r.Z.Option,{key:e._id,value:e.name},e.name))))),n.createElement(o.Z.Item,{wrapperCol:{offset:8,span:12}},n.createElement(m.Z,{type:"primary",htmlType:"submit"},"确认"))))}})||I;class f extends n.Component{render(){console.log("Class.props",this.props);const{match:e}=this.props;return n.createElement("div",null,"Class",n.createElement(i.rs,null,n.createElement(i.AW,{path:e.path+"/add",component:u}),n.createElement(i.AW,{path:e.path+"/list",component:C}),n.createElement(i.AW,{path:e.path+"/:id",component:w}),n.createElement(i.l_,{from:e.path,to:e.path+"/list",exact:!0})))}}const v=f}}]);